{
  "hash": "815acb6d7b7f20e02676649742c6cf1d",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"AE 18: Houses in Duke Forest\"\nsubtitle: \"Suggested answers\"\ncategories: \n  - Application exercise\n  - Answers\n---\n\n\n\n\n\n::: callout-important\nThese are suggested answers.\nThis document should be used as reference only, it's not designed to be an exhaustive key.\n:::\n\nIn this application exercise, we will use bootstrapping to construct confidence intervals.\n\n## Packages\n\nWe will use **tidyverse** and **tidymodels** for data exploration and modeling, respectively, and the **openintro** package for the data, and the **knitr** package for formatting tables.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(tidymodels)\nlibrary(openintro)\nlibrary(knitr)\n```\n:::\n\n\n\n\n\n## Data\n\nThe data are on houses that were sold in the Duke Forest neighborhood of Durham, NC around November 2020.\nIt was originally scraped from Zillow, and can be found in the `duke_forest` data set in the **openintro** R package.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nglimpse(duke_forest)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 98\nColumns: 13\n$ address    <chr> \"1 Learned Pl, Durham, NC 27705\", \"1616 Pinecrest Rd, Durha…\n$ price      <dbl> 1520000, 1030000, 420000, 680000, 428500, 456000, 1270000, …\n$ bed        <dbl> 3, 5, 2, 4, 4, 3, 5, 4, 4, 3, 4, 4, 3, 5, 4, 5, 3, 4, 4, 3,…\n$ bath       <dbl> 4.0, 4.0, 3.0, 3.0, 3.0, 3.0, 5.0, 3.0, 5.0, 2.0, 3.0, 3.0,…\n$ area       <dbl> 6040, 4475, 1745, 2091, 1772, 1950, 3909, 2841, 3924, 2173,…\n$ type       <chr> \"Single Family\", \"Single Family\", \"Single Family\", \"Single …\n$ year_built <dbl> 1972, 1969, 1959, 1961, 2020, 2014, 1968, 1973, 1972, 1964,…\n$ heating    <chr> \"Other, Gas\", \"Forced air, Gas\", \"Forced air, Gas\", \"Heat p…\n$ cooling    <fct> central, central, central, central, central, central, centr…\n$ parking    <chr> \"0 spaces\", \"Carport, Covered\", \"Garage - Attached, Covered…\n$ lot        <dbl> 0.97, 1.38, 0.51, 0.84, 0.16, 0.45, 0.94, 0.79, 0.53, 0.73,…\n$ hoa        <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ url        <chr> \"https://www.zillow.com/homedetails/1-Learned-Pl-Durham-NC-…\n```\n\n\n:::\n:::\n\n\n\n\n\n## Model\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf_fit <- linear_reg() |>\n  set_engine(\"lm\") |>\n  fit(price ~ area, data = duke_forest)\n\ntidy(df_fit) |>\n  kable(digits = 2)\n```\n\n::: {.cell-output-display}\n\n\n|term        |  estimate| std.error| statistic| p.value|\n|:-----------|---------:|---------:|---------:|-------:|\n|(Intercept) | 116652.33|  53302.46|      2.19|    0.03|\n|area        |    159.48|     18.17|      8.78|    0.00|\n\n\n:::\n:::\n\n\n\n\n\n## Bootstrap confidence interval\n\n### 1. Calculate the observed fit (slope)\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nobserved_fit <- duke_forest |>\n  specify(price ~ area) |>\n  fit()\n\nobserved_fit\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 2 × 2\n  term      estimate\n  <chr>        <dbl>\n1 intercept  116652.\n2 area          159.\n```\n\n\n:::\n:::\n\n\n\n\n\n### 2. Take *n* bootstrap samples and fit models to each one.\n\nFill in the code, then set `eval: true` .\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nn = 100\nset.seed(20241115)\n\nboot_fits <- duke_forest |>\n  specify(price ~ area) |>\n  generate(reps = n, type = \"bootstrap\") |>\n  fit()\n\nboot_fits\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 200 × 3\n# Groups:   replicate [100]\n   replicate term      estimate\n       <int> <chr>        <dbl>\n 1         1 intercept  149083.\n 2         1 area          143.\n 3         2 intercept  226037.\n 4         2 area          110.\n 5         3 intercept   37464.\n 6         3 area          188.\n 7         4 intercept    7631.\n 8         4 area          208.\n 9         5 intercept  245406.\n10         5 area          104.\n# ℹ 190 more rows\n```\n\n\n:::\n:::\n\n\n\n\n\n-   Why do we set a seed before taking the bootstrap samples?\n\n-   Make a histogram of the bootstrap samples to visualize the bootstrap distribution.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nboot_fits |>\n  filter(term == \"area\") |>\n  ggplot(aes(x = estimate)) +\n  geom_histogram()\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](ae-18-duke-forest-bootstrap-A_files/figure-html/boot-hist-1.png){width=672}\n:::\n:::\n\n\n\n\n\n### 3. Compute the 95% confidence interval as the middle 95% of the bootstrap distribution\n\nFill in the code, then set `eval: true` .\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nget_confidence_interval(\n  boot_fits, \n  point_estimate = observed_fit, \n  level = 0.95,\n  type = \"percentile\"\n)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 2 × 3\n  term      lower_ci upper_ci\n  <chr>        <dbl>    <dbl>\n1 area          79.9     207.\n2 intercept  -3694.   316939.\n```\n\n\n:::\n:::\n\n\n\n\n\n## Changing confidence level\n\n### Modify the code from Step 3 to create a 90% confidence interval.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nget_confidence_interval(\n  boot_fits, \n  point_estimate = observed_fit, \n  level = 0.90,\n  type = \"percentile\"\n)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 2 × 3\n  term      lower_ci upper_ci\n  <chr>        <dbl>    <dbl>\n1 area          94.7     203.\n2 intercept   8234.   284161.\n```\n\n\n:::\n:::\n\n\n\n\n\n### Modify the code from Step 3 to create a 99% confidence interval.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nget_confidence_interval(\n  boot_fits, \n  point_estimate = observed_fit, \n  level = 0.99,\n  type = \"percentile\"\n)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 2 × 3\n  term      lower_ci upper_ci\n  <chr>        <dbl>    <dbl>\n1 area          64.2     211.\n2 intercept -19831.   370166.\n```\n\n\n:::\n:::\n\n\n\n\n\n-   Which confidence level produces the most accurate confidence interval (90%, 95%, 99%)?\n    Explain\n\n-   Which confidence level produces the most precise confidence interval (90%, 95%, 99%)?\n    Explain\n\n-   If we want to be very certain that we capture the population parameter, should we use a wider or a narrower interval?\n    What drawbacks are associated with using a wider interval?\n",
    "supporting": [
      "ae-18-duke-forest-bootstrap-A_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}