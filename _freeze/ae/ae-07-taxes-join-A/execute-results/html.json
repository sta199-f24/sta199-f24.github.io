{
  "hash": "e5de21ebc31992cecad71a9d3167fd77",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"AE 07: Sales taxes + data joining\"\nsubtitle: \"Suggested answers\"\n---\n\n\n\n::: callout-important\nThese are suggested answers.\nThis document should be used as a reference only; it's not designed to be an exhaustive key.\n:::\n\n## Getting started\n\n### Packages\n\nWe'll use the **tidyverse** package for this analysis.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n:::\n\n\n\n### Data\n\nThe data are available in the `data` folder.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsales_taxes <- read_csv(\"data/sales-taxes.csv\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nRows: 51 Columns: 5\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (1): state\ndbl (4): state_tax_rate, avg_local_tax_rate, combined_rate, max_local_tax_rate\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n\n\n:::\n\n```{.r .cell-code}\nus_regions <- read_csv(\"data/us-regions.csv\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nRows: 50 Columns: 2\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (2): state_name, region\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n\n\n:::\n:::\n\n\n\nAnd let's take a look at the data.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nglimpse(sales_taxes)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 51\nColumns: 5\n$ state              <chr> \"Alabama\", \"Alaska\", \"Arizona\", \"Arkansas\", \"Califo…\n$ state_tax_rate     <dbl> 0.0400, 0.0000, 0.0560, 0.0650, 0.0725, 0.0290, 0.0…\n$ avg_local_tax_rate <dbl> 0.0529, 0.0182, 0.0278, 0.0295, 0.0160, 0.0491, 0.0…\n$ combined_rate      <dbl> 0.0929, 0.0182, 0.0838, 0.0945, 0.0885, 0.0781, 0.0…\n$ max_local_tax_rate <dbl> 0.0750, 0.0785, 0.0530, 0.0613, 0.0475, 0.0830, 0.0…\n```\n\n\n:::\n\n```{.r .cell-code}\nglimpse(us_regions)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 50\nColumns: 2\n$ state_name <chr> \"Maine\", \"New Hampshire\", \"Vermont\", \"Massachusetts\", \"Rhod…\n$ region     <chr> \"Northeast\", \"Northeast\", \"Northeast\", \"Northeast\", \"Northe…\n```\n\n\n:::\n:::\n\n\n\n## Joining\n\nJoin the sales tax data with region data and save the joined data frame as a new data frame, not overwriting either data frame that goes into the join.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsales_taxes_regions <- left_join(\n  sales_taxes, \n  us_regions, \n  by = join_by(state == state_name)\n)\n```\n:::\n\n\n\nCalculate the average sales tax of states in each region.\nWhat is surprising in the output?\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsales_taxes_regions |>\n  group_by(region) |>\n  summarize(mean_state_tax = mean(state_tax_rate))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 5 × 2\n  region    mean_state_tax\n  <chr>              <dbl>\n1 Midwest           0.0569\n2 Northeast         0.0530\n3 South             0.0523\n4 West              0.0416\n5 <NA>              0.06  \n```\n\n\n:::\n:::\n\n\n\nIdentify the state with `NA` for region.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsales_taxes_regions |>\n  filter(is.na(region)) |>\n  select(state, region)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1 × 2\n  state                region\n  <chr>                <chr> \n1 District of Columbia <NA>  \n```\n\n\n:::\n:::\n\n\n\nApply a fix for the `NA` in region, and calculate the mean sales taxes for regions again.\nDisplay the results in ascending order of mean sales tax.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsales_taxes_regions <- sales_taxes_regions |>\n  mutate(\n    region = if_else(state == \"District of Columbia\", \"Northeast\", region)\n  )\n\nsales_taxes_regions |>\n  group_by(region) |>\n  summarize(mean_state_tax = mean(state_tax_rate)) |>\n  arrange(mean_state_tax)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 4 × 2\n  region    mean_state_tax\n  <chr>              <dbl>\n1 West              0.0416\n2 South             0.0523\n3 Northeast         0.0537\n4 Midwest           0.0569\n```\n\n\n:::\n:::\n\n\n\n## Render, commit, and push\n\n1.  Render your Quarto document.\n\n2.  Go to the Git pane and check the box next to each file listed, i.e., stage your changes.\n    Commit your staged changes using a simple and informative message.\n\n3.  Click on push (the green arrow) to push your changes to your application exercise repo on GitHub.\n\n4.  Go to your repo on GitHub and confirm that you can see the updated files.\n    Once your updated files are in your repo on GitHub, you're good to go!\n",
    "supporting": [
      "ae-07-taxes-join-A_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}