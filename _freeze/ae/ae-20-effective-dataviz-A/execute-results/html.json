{
  "hash": "a32fea770a3fe8b25892a9e78b609855",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Trends instructional staff employees in universities\"\ncategories: \n  - Application exercise\n  - Answers\n---\n\n\n\nThe American Association of University Professors (AAUP) is a nonprofit membership association of faculty and other academic professionals.\n[This report](https://www.aaup.org/sites/default/files/files/AAUP_Report_InstrStaff-75-11_apr2013.pdf) by the AAUP shows trends in instructional staff employees between 1975 and 2011, and contains the following image.\nWhat trends are apparent in this visualization?\n\n![](images/staff-employment.png){fig-align=\"center\"}\n\n## Packages\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(scales)\nlibrary(ggthemes)\n```\n:::\n\n\n\n## Data\n\nEach row in this dataset represents a faculty type, and the columns are the years for which we have data.\nThe values are percentage of hires of that type of faculty for each year.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstaff <- read_csv(\"https://sta199-s24.github.io/data/instructional-staff.csv\")\nstaff\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 5 × 12\n  faculty_type    `1975` `1989` `1993` `1995` `1999` `2001` `2003` `2005` `2007`\n  <chr>            <dbl>  <dbl>  <dbl>  <dbl>  <dbl>  <dbl>  <dbl>  <dbl>  <dbl>\n1 Full-Time Tenu…   29     27.6   25     24.8   21.8   20.3   19.3   17.8   17.2\n2 Full-Time Tenu…   16.1   11.4   10.2    9.6    8.9    9.2    8.8    8.2    8  \n3 Full-Time Non-…   10.3   14.1   13.6   13.6   15.2   15.5   15     14.8   14.9\n4 Part-Time Facu…   24     30.4   33.1   33.2   35.5   36     37     39.3   40.5\n5 Graduate Stude…   20.5   16.5   18.1   18.8   18.7   19     20     19.9   19.5\n# ℹ 2 more variables: `2009` <dbl>, `2011` <dbl>\n```\n\n\n:::\n:::\n\n\n\n## Recreate\n\n-   **Your turn:** Recreate the visualization above. Try to match as many of the elements as possible. Hint: You might need to reshape your data first.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstaff_long <- staff |>\n  pivot_longer(\n    cols = -faculty_type, names_to = \"year\",\n    values_to = \"percentage\"\n  ) |>\n  mutate(\n    percentage = as.numeric(percentage),\n    faculty_type = fct_relevel(\n      faculty_type,\n      \"Full-Time Tenured Faculty\",\n      \"Full-Time Tenure-Track Faculty\",\n      \"Full-Time Non-Tenure-Track Faculty\",\n      \"Part-Time Faculty\",\n      \"Graduate Student Employees\"\n    )\n  )\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(\n  staff_long,\n  aes(\n    x = str_wrap(faculty_type, 20),\n    y = percentage,\n    fill = year\n    )\n  ) +\n  geom_col(position = \"dodge\") +\n  scale_y_continuous(breaks = seq(5, 45, 5), limits = c(0, 45)) +\n  labs(\n    x = NULL,\n    y = \"Percent of Total Instructional Staff\",\n    fill = NULL,\n    title = \"Trends in Instructional Staff Employment Status, 1975-2011\",\n    subtitle = \"All Institutions, National Totals\",\n    caption = \"Source: US Department of Education, IPEDS Fall Staff Survey\"\n  ) +\n  theme(\n    legend.position = c(0.4, 0.93),\n    legend.direction = \"horizontal\",\n    legend.key.size = unit(0.2, \"cm\"),\n    legend.key.height = unit(0.1, \"cm\"),\n    legend.text.align = 0,\n    legend.background = element_rect(color = \"black\", linewidth = 0.2),\n    legend.text = element_text(size = 7),\n    panel.grid.minor = element_blank(),\n    panel.grid.major.x = element_blank(),\n    plot.caption = element_text(size = 8, hjust = 0)\n  ) +\n  guides(fill = guide_legend(nrow = 1))\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: The `legend.text.align` argument of `theme()` is deprecated as of ggplot2\n3.5.0.\nℹ Please use theme(legend.text = element_text(hjust)) instead.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: A numeric `legend.position` argument in `theme()` was deprecated in ggplot2\n3.5.0.\nℹ Please use the `legend.position.inside` argument of `theme()` instead.\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](ae-20-effective-dataviz-A_files/figure-html/unnamed-chunk-4-1.png){width=1152}\n:::\n:::\n\n\n\n## Represent percentages as parts of a whole\n\n-   **Demo:** Recreate the previous visualization where the percentages are represented as parts of a whole.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(\n  staff_long,\n  aes(\n    x = str_wrap(faculty_type, 20),\n    y = percentage,\n    fill = fct_rev(year)\n    )\n  ) +\n  geom_col(position = \"fill\", color = \"white\", linewidth = 0.2) +\n  scale_y_continuous(labels = label_percent()) +\n  labs(\n    x = NULL,\n    y = \"Percent of Total Instructional Staff\",\n    fill = NULL,\n    title = \"Trends in Instructional Staff Employment Status, 1975-2011\",\n    subtitle = \"All Institutions, National Totals\",\n    caption = \"Source: US Department of Education, IPEDS Fall Staff Survey\"\n  ) +\n  theme(\n    legend.text.align = 0,\n    legend.background = element_rect(color = \"black\", size = 0.2),\n    legend.text = element_text(size = 7),\n    panel.grid.minor = element_blank(),\n    panel.grid.major.x = element_blank(),\n    plot.caption = element_text(size = 8, hjust = 0)\n  )\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: The `size` argument of `element_rect()` is deprecated as of ggplot2 3.4.0.\nℹ Please use the `linewidth` argument instead.\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](ae-20-effective-dataviz-A_files/figure-html/unnamed-chunk-5-1.png){width=1152}\n:::\n:::\n\n\n\n## Place time on x-axis\n\n-   **Demo:** Convert the visualization to a line plot with time on the x-axis.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(\n  staff_long,\n  aes(\n    x = year,\n    y = percentage,\n    color = str_wrap(faculty_type, 20),\n    group = str_wrap(faculty_type, 20)\n    )\n  ) +\n  geom_line(linewidth = 1) +\n  labs(\n    x = NULL,\n    y = \"Percent of Total Instructional Staff\",\n    color = NULL,\n    title = \"Trends in Instructional Staff Employment Status, 1975-2011\",\n    subtitle = \"All Institutions, National Totals\",\n    caption = \"Source: US Department of Education, IPEDS Fall Staff Survey\"\n  ) +\n  scale_y_continuous(labels = label_percent(accuracy = 1, scale = 1)) +\n  theme(\n    legend.key.height = unit(1.5, \"cm\"),\n    plot.caption = element_text(size = 8, hjust = 0)\n  )\n```\n\n::: {.cell-output-display}\n![](ae-20-effective-dataviz-A_files/figure-html/unnamed-chunk-6-1.png){width=1152}\n:::\n:::\n\n\n\n## Pay attention to variable types\n\n-   **Question:** What is wrong with the x-axis of the plot above? How can you fix it?\n\nTime is represented as a character string (equally spaces between levels) instead of on a continuous scale (with spacing indicating numbers of years between ticks.\n\n-   **Your turn:** Implement the fix for the x-axis of the plot.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstaff_long <- staff_long |>\n  mutate(year = as.numeric(year))\n\nggplot(\n  staff_long,\n  aes(\n    x = year,\n    y = percentage,\n    color = str_wrap(faculty_type, 20),\n    group = str_wrap(faculty_type, 20)\n  )\n) +\n  geom_line(linewidth = 1) +\n  labs(\n    x = NULL,\n    y = \"Percent of Total Instructional Staff\",\n    color = NULL,\n    title = \"Trends in Instructional Staff Employment Status, 1975-2011\",\n    subtitle = \"All Institutions, National Totals\",\n    caption = \"Source: US Department of Education, IPEDS Fall Staff Survey\"\n  ) +\n  scale_y_continuous(labels = label_percent(accuracy = 1, scale = 1)) +\n  theme(\n    legend.key.height = unit(1.5, \"cm\"),\n    plot.caption = element_text(size = 8, hjust = 0)\n  )\n```\n\n::: {.cell-output-display}\n![](ae-20-effective-dataviz-A_files/figure-html/unnamed-chunk-7-1.png){width=1152}\n:::\n:::\n\n\n\n## Use an accessible color scale\n\n**Question:** What do we mean by an accessible color scale?\nWhat types of color vision deficiencies are there?\n\n-   **Demo:** What does the plot look like to people with various color vision deficiencies?\n\n-   **Demo:** Remake the plot with an accessible color scale.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(\n  staff_long,\n  aes(\n    x = year,\n    y = percentage,\n    color = str_wrap(faculty_type, 20),\n    group = str_wrap(faculty_type, 20)\n    )\n  ) +\n  geom_line(linewidth = 1) +\n  labs(\n    x = NULL,\n    y = \"Percent of Total Instructional Staff\",\n    color = NULL,\n    title = \"Trends in Instructional Staff Employment Status, 1975-2011\",\n    subtitle = \"All Institutions, National Totals\",\n    caption = \"Source: US Department of Education, IPEDS Fall Staff Survey\"\n  ) +\n  scale_y_continuous(labels = label_percent(accuracy = 1, scale = 1)) +\n  theme(\n    legend.key.height = unit(1.5, \"cm\"),\n    plot.caption = element_text(size = 8, hjust = 0)\n  ) +\n  scale_color_colorblind() # from ggthemes package\n```\n\n::: {.cell-output-display}\n![](ae-20-effective-dataviz-A_files/figure-html/unnamed-chunk-8-1.png){width=1152}\n:::\n:::\n\n\n\n## Use direct labeling\n\n-   **Demo:** Remove the legend and add labels for each line at the end of the line (where `x` is the `max(x)` recorded).\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(\n  staff_long,\n  aes(\n    x = year,\n    y = percentage,\n    color = faculty_type,\n    group = faculty_type\n    )\n  ) +\n  geom_line(linewidth = 1, show.legend = FALSE) +\n  geom_text(\n    data = staff_long |> filter(year == max(year)),\n    aes(x = year + 1, y = percentage, label = faculty_type),\n    hjust = \"left\", show.legend = FALSE, size = 4\n  ) +\n  labs(\n    x = NULL,\n    y = \"Percent of Total Instructional Staff\",\n    color = NULL,\n    title = \"Trends in Instructional Staff Employment Status, 1975-2011\",\n    subtitle = \"All Institutions, National Totals\",\n    caption = \"Source: US Department of Education, IPEDS Fall Staff Survey\"\n  ) +\n  scale_y_continuous(labels = label_percent(accuracy = 1, scale = 1)) +\n  theme(\n    plot.caption = element_text(size = 8, hjust = 0),\n    plot.margin = margin(0.1, 2.5, 0.1, 0.1, unit = \"in\")\n  ) +\n  coord_cartesian(clip = \"off\") +\n  scale_color_colorblind()\n```\n\n::: {.cell-output-display}\n![](ae-20-effective-dataviz-A_files/figure-html/unnamed-chunk-9-1.png){width=1152}\n:::\n:::\n\n\n\n## Use color to draw attention\n\n-   **Demo:** Redo the line plot where Part-time Faculty is red and the rest are gray.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstaff_long <- staff_long |>\n  mutate(faculty_type_color = if_else(faculty_type == \"Part-Time Faculty\", \"firebrick3\", \"gray40\"))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(\n  staff_long,\n  aes(\n    x = year,\n    y = percentage,\n    color = faculty_type_color, group = faculty_type\n    )\n  ) +\n  geom_line(linewidth = 1, show.legend = FALSE) +\n  geom_text(\n    data = staff_long |> filter(year == max(year)),\n    aes(x = year + 1, y = percentage, label = faculty_type),\n    hjust = \"left\", show.legend = FALSE, size = 4\n  ) +\n  labs(\n    x = NULL,\n    y = \"Percent of Total Instructional Staff\",\n    color = NULL,\n    title = \"Trends in Instructional Staff Employment Status, 1975-2011\",\n    subtitle = \"All Institutions, National Totals\",\n    caption = \"Source: US Department of Education, IPEDS Fall Staff Survey\"\n  ) +\n  scale_y_continuous(labels = label_percent(accuracy = 1, scale = 1)) +\n  scale_color_identity() +\n  theme(\n    plot.caption = element_text(size = 8, hjust = 0),\n    plot.margin = margin(0.1, 2.5, 0.1, 0.1, unit = \"in\")\n  ) +\n  coord_cartesian(clip = \"off\")\n```\n\n::: {.cell-output-display}\n![](ae-20-effective-dataviz-A_files/figure-html/unnamed-chunk-11-1.png){width=1152}\n:::\n:::\n\n\n\n## We could keep going...\n\nLet's go back to the slides for that.\n",
    "supporting": [
      "ae-20-effective-dataviz-A_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}